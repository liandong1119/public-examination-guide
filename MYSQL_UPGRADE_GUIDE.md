# ğŸ—„ï¸ MySQLæ•°æ®åº“å‡çº§æŒ‡å—

## ğŸ“‹ å‡çº§æ¦‚è¿°

æ‚¨çš„æœé—»é˜é¡¹ç›®å·²æˆåŠŸå‡çº§åˆ°MySQLæ•°æ®åº“ç³»ç»Ÿï¼è¿™æ¬¡å‡çº§å¸¦æ¥äº†ï¼š

### âœ… å‡çº§ä¼˜åŠ¿
- **ğŸ”’ ä¼ä¸šçº§å®‰å…¨æ€§**ï¼šæ”¯æŒACIDäº‹åŠ¡ï¼Œæ•°æ®å®‰å…¨å¯é 
- **âš¡ é«˜æ€§èƒ½**ï¼šæ”¯æŒæ•°åƒå¹¶å‘è¿æ¥ï¼ŒæŸ¥è¯¢æ€§èƒ½å¤§å¹…æå‡
- **ğŸ“ˆ å¯æ‰©å±•æ€§**ï¼šè½»æ¾æ”¯æŒç”¨æˆ·å¢é•¿å’Œæ•°æ®æ‰©å±•
- **ğŸ”„ æ˜“è¿ç§»**ï¼šæ ‡å‡†SQLï¼Œä¾¿äºåæœŸåˆ‡æ¢å…¶ä»–åç«¯æœåŠ¡
- **ğŸ›¡ï¸ æ•°æ®å®Œæ•´æ€§**ï¼šå¤–é”®çº¦æŸã€ç´¢å¼•ä¼˜åŒ–ã€äº‹åŠ¡ä¿æŠ¤

### ğŸ†š å¯¹æ¯”åˆ†æ

| ç‰¹æ€§ | åŸJSONæ–‡ä»¶ | æ–°MySQLæ•°æ®åº“ |
|------|------------|---------------|
| **å®‰å…¨æ€§** | âš ï¸ ä¸­ç­‰ | âœ… ä¼ä¸šçº§ |
| **å¹¶å‘æ€§** | âŒ ä¸æ”¯æŒ | âœ… æ•°åƒè¿æ¥ |
| **æ€§èƒ½** | âš ï¸ æ–‡ä»¶è¯»å†™ | âœ… å†…å­˜+ç´¢å¼• |
| **æ‰©å±•æ€§** | âŒ æœ‰é™ | âœ… æ— é™æ‰©å±• |
| **è¿ç§»æ€§** | âš ï¸ å›°éš¾ | âœ… æ ‡å‡†SQL |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿æ‚¨å·²å®‰è£…MySQLæœåŠ¡å™¨ï¼š

```bash
# Windows (ä½¿ç”¨MySQL Installer)
# ä¸‹è½½: https://dev.mysql.com/downloads/installer/

# macOS (ä½¿ç”¨Homebrew)
brew install mysql
brew services start mysql

# Ubuntu/Debian
sudo apt update
sudo apt install mysql-server
sudo systemctl start mysql
```

### 2. é…ç½®æ•°æ®åº“

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ‚¨çš„MySQLè¿æ¥ä¿¡æ¯ï¼š

```env
# ğŸ—„ï¸ MySQLæ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_NAME=civil_service_exam
DB_USER=root
DB_PASSWORD=your_mysql_password

# ğŸ” å®‰å…¨é…ç½®
JWT_SECRET=your_jwt_secret_here
BCRYPT_ROUNDS=12
```

### 3. ä¸€é”®è®¾ç½®æ•°æ®åº“

è¿è¡Œè‡ªåŠ¨è®¾ç½®è„šæœ¬ï¼š

```bash
npm run setup:mysql
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… æ£€æŸ¥ç¯å¢ƒé…ç½®
- âœ… æµ‹è¯•MySQLè¿æ¥
- âœ… åˆ›å»ºæ•°æ®åº“å’Œè¡¨ç»“æ„
- âœ… è¿ç§»ç°æœ‰JSONæ•°æ®
- âœ… éªŒè¯è®¾ç½®å®Œæˆ

### 4. å¯åŠ¨æœåŠ¡

```bash
npm run server
```

è®¿é—®åå°ç®¡ç†ï¼šhttp://localhost:3001/admin/
- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`123456`

## ğŸ“Š æ•°æ®åº“ç»“æ„

### æ ¸å¿ƒè¡¨ç»“æ„

```sql
ğŸ“ æ•°æ®åº“è¡¨
â”œâ”€â”€ users          # ğŸ‘¥ ç”¨æˆ·ç®¡ç†
â”œâ”€â”€ categories     # ğŸ“š åˆ†ç±»ç®¡ç†
â”œâ”€â”€ tags           # ğŸ·ï¸ æ ‡ç­¾ç®¡ç†
â”œâ”€â”€ content        # ğŸ“ å†…å®¹ç®¡ç†
â”œâ”€â”€ content_tags   # ğŸ”— å†…å®¹æ ‡ç­¾å…³è”
â”œâ”€â”€ visits         # ğŸ“Š è®¿é—®ç»Ÿè®¡
â”œâ”€â”€ analytics      # ğŸ“ˆ åˆ†ææ•°æ®
â”œâ”€â”€ comments       # ğŸ’¬ è¯„è®ºç³»ç»Ÿï¼ˆé¢„ç•™ï¼‰
â”œâ”€â”€ system_config  # ğŸ”§ ç³»ç»Ÿé…ç½®
â””â”€â”€ files          # ğŸ“ æ–‡ä»¶ç®¡ç†
```

### å®‰å…¨ç‰¹æ€§

- **ğŸ” å¯†ç åŠ å¯†**ï¼šä½¿ç”¨bcryptåŠ å¯†ç”¨æˆ·å¯†ç 
- **ğŸ›¡ï¸ SQLæ³¨å…¥é˜²æŠ¤**ï¼šå‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢æ³¨å…¥æ”»å‡»
- **ğŸ”’ è¿æ¥å®‰å…¨**ï¼šè¿æ¥æ± ç®¡ç†ï¼Œé˜²æ­¢è¿æ¥æ³„éœ²
- **ğŸ“ å®¡è®¡æ—¥å¿—**ï¼šå®Œæ•´çš„æ“ä½œè®°å½•å’Œé”™è¯¯æ—¥å¿—

## ğŸ”§ å¸¸ç”¨æ“ä½œ

### æ•°æ®è¿ç§»

å¦‚æœéœ€è¦é‡æ–°è¿ç§»æ•°æ®ï¼š

```bash
npm run migrate
```

### æ•°æ®åº“æµ‹è¯•

æµ‹è¯•æ•°æ®åº“è¿æ¥å’ŒåŸºæœ¬æ“ä½œï¼š

```bash
npm run test:db
```

### å¤‡ä»½æ•°æ®

```bash
# å¤‡ä»½æ•´ä¸ªæ•°æ®åº“
mysqldump -u root -p civil_service_exam > backup.sql

# æ¢å¤æ•°æ®åº“
mysql -u root -p civil_service_exam < backup.sql
```

## ğŸ”„ APIå˜åŒ–

### å‘åå…¼å®¹

æ‰€æœ‰åŸæœ‰çš„APIæ¥å£ä¿æŒä¸å˜ï¼Œä½†ç°åœ¨éƒ½æ˜¯å¼‚æ­¥æ“ä½œï¼š

```javascript
// åŸæ¥ï¼ˆåŒæ­¥ï¼‰
const content = db.read('content');

// ç°åœ¨ï¼ˆå¼‚æ­¥ï¼Œä½†APIç›¸åŒï¼‰
const content = await db.read('content');
```

### æ–°å¢åŠŸèƒ½

```javascript
// é«˜çº§æŸ¥è¯¢
const results = await db.query('content', {
  where: { status: 'published' },
  orderBy: 'created_at',
  orderDirection: 'DESC',
  limit: 10
});

// äº‹åŠ¡æ“ä½œ
const connection = await db.mysql.beginTransaction();
try {
  await db.mysql.create('content', data);
  await db.mysql.commitTransaction(connection);
} catch (error) {
  await db.mysql.rollbackTransaction(connection);
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### å·²å®ç°çš„ä¼˜åŒ–

- âœ… **æ•°æ®åº“ç´¢å¼•**ï¼šä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
- âœ… **è¿æ¥æ± **ï¼šå¤ç”¨æ•°æ®åº“è¿æ¥ï¼Œæé«˜æ€§èƒ½
- âœ… **æŸ¥è¯¢ä¼˜åŒ–**ï¼šä½¿ç”¨JOINå‡å°‘æŸ¥è¯¢æ¬¡æ•°
- âœ… **å¹¶è¡ŒæŸ¥è¯¢**ï¼šç»Ÿè®¡æ•°æ®å¹¶è¡Œè·å–

### æ€§èƒ½ç›‘æ§

```javascript
// æŸ¥çœ‹è¿æ¥æ± çŠ¶æ€
console.log(db.mysql.pool.config);

// ç›‘æ§æ…¢æŸ¥è¯¢
// åœ¨MySQLä¸­å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—
```

## ğŸ”® æœªæ¥æ‰©å±•

### æ”¯æŒçš„åç«¯åˆ‡æ¢

ç”±äºä½¿ç”¨æ ‡å‡†SQLï¼Œæ‚¨å¯ä»¥è½»æ¾åˆ‡æ¢åˆ°ï¼š

- **PostgreSQL**ï¼šä¼ä¸šçº§å¼€æºæ•°æ®åº“
- **SQL Server**ï¼šå¾®è½¯ä¼ä¸šæ•°æ®åº“
- **Oracle**ï¼šå¤§å‹ä¼ä¸šæ•°æ®åº“
- **äº‘æ•°æ®åº“**ï¼šAWS RDSã€é˜¿é‡Œäº‘RDSç­‰

### å¾®æœåŠ¡æ¶æ„

æ•°æ®åº“å±‚å·²ä¸ºå¾®æœåŠ¡æ¶æ„åšå¥½å‡†å¤‡ï¼š

```javascript
// å¯ä»¥è½»æ¾æ‹†åˆ†ä¸ºç‹¬ç«‹æœåŠ¡
const userService = new UserService(db);
const contentService = new ContentService(db);
const analyticsService = new AnalyticsService(db);
```

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: è¿æ¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
```bash
# æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€
sudo systemctl status mysql

# æ£€æŸ¥ç«¯å£æ˜¯å¦å¼€æ”¾
netstat -an | grep 3306

# æµ‹è¯•è¿æ¥
mysql -u root -p -h localhost
```

**Q: æ•°æ®è¿ç§»å¤±è´¥ï¼Ÿ**
```bash
# æŸ¥çœ‹è¿ç§»æ—¥å¿—
cat database/migration_report.json

# æ‰‹åŠ¨é‡æ–°è¿ç§»
npm run migrate
```

**Q: æ€§èƒ½é—®é¢˜ï¼Ÿ**
```sql
-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SHOW VARIABLES LIKE 'slow_query_log';

-- åˆ†ææŸ¥è¯¢æ€§èƒ½
EXPLAIN SELECT * FROM content WHERE status = 'published';
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. **ç¯å¢ƒé…ç½®**ï¼šç¡®è®¤.envæ–‡ä»¶é…ç½®æ­£ç¡®
2. **MySQLæœåŠ¡**ï¼šç¡®è®¤MySQLæœåŠ¡æ­£åœ¨è¿è¡Œ
3. **æƒé™è®¾ç½®**ï¼šç¡®è®¤æ•°æ®åº“ç”¨æˆ·æœ‰è¶³å¤Ÿæƒé™
4. **ç½‘ç»œè¿æ¥**ï¼šç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

å‡çº§å®Œæˆï¼æ‚¨çš„æœé—»é˜ç°åœ¨æ‹¥æœ‰äº†ä¼ä¸šçº§çš„æ•°æ®åº“æ”¯æŒï¼ğŸ‰
